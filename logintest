
const url = 'url';
const username = 'USERNAME';
const password = 'PASSWORD';

const start = Date.now();

try {
    // Step 1 — Open login page
    const res = HttpRequest.get({ url: url, timeout: 10000 });

    if (res.status !== 200) {
        return JSON.stringify({
            status: 'FAIL',
            step: 'OpenLoginPage',
            http_status: res.status,
            message: 'Login page not reachable',
            response_time: 0
        });
    }

    // Step 2 — Attempt login (adjust parameter names if needed)
    const loginRes = HttpRequest.post({
        url: url,
        timeout: 10000,
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        data: `userNameInput=${encodeURIComponent(username)}&passwordInput=${encodeURIComponent(password)}`
    });

    const elapsed = (Date.now() - start) / 1000.0;

    // Step 3 — Check for success keyword
    if (loginRes.status === 200 && loginRes.body && loginRes.body.includes('Overview')) {
        return JSON.stringify({
            status: 'OK',
            step: 'LoginCheck',
            http_status: loginRes.status,
            response_time: elapsed,
            message: 'Login OK (Overview found)'
        });
    } else {
        return JSON.stringify({
            status: 'FAIL',
            step: 'LoginCheck',
            http_status: loginRes.status,
            response_time: elapsed,
            message: 'Login failed or "Overview" not found'
        });
    }
} catch (error) {
    const elapsed = (Date.now() - start) / 1000.0;
    return JSON.stringify({
        status: 'ERROR',
        message: `Exception: ${error.message}`,
        response_time: elapsed
    });
}
