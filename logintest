var browser, result;
var browser = new Browser(Browser.chromeOptions());

try {
    var params = JSON.parse(value);
    var url = params.webURL;
    var username = params.username;
    var password = params.password;

    // Optional screen size
    browser.setScreenSize(1366, 768);

    // Step 1 — Navigate to login page
    browser.navigate(url);

    // Step 2 — Wait for login form to appear
    browser.awaitElement('input[name="userNameInput"]', 5000);

    // Step 3 — Enter credentials
    browser.element('input[name="userNameInput"]').setValue(username);
    browser.element('input[name="passwordInput"]').setValue(password);

    // Step 4 — Click login button
    browser.element('button[type="submit"]').click();

    // Step 5 — Wait for "Overview" keyword
    browser.awaitText('Overview', 10000);

    // Step 6 — Collect results
    result = browser.getResult();
    result.screenshot = browser.getScreenshot();
    result.status = 'OK';
    result.message = 'Login OK (Overview found)';
}
catch (err) {
    if (!(err instanceof BrowserError)) {
        browser.setError(err.message);
    }
    result = browser.getResult();
    result.error = { message: err.message };
    result.error.screenshot = browser.getScreenshot();
    result.status = 'FAIL';
    result.message = 'Login failed or Overview not found';
}
finally {
    return JSON.stringify(result);
}
